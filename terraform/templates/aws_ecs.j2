
module "{{ profile }}_{{ resource_name }}_aws_ecs" {
  source                          = "../modules/aws_ecs"
  name                            = "{{ profile }}_{{ resource_name }}"
  image_url                       = "{{ params['image_url'] }}"
  image_tag                       = "{{ params['image_tag'] }}"
  task_cpu_units                  = {{ params['task_cpu_units'] }}
  task_memory                     = {{ params['task_memory'] }}
  container_cpu_units             = {{ params['container_cpu_units'] }}
  container_memory                = {{ params['container_memory'] }}
  container_environment_variables = {{ params['environment_variables'] }}
  open_ports                      = {{ params['open_ports'] | replace("'","") }}
  desired_count                   = {{ params['desired_count'] }}
  assign_public_ip                = {{ params['assign_public_ip'] }}
  subnet_ids                      = {{ params['subnet_ids'] | replace("'","\"") }}
  security_groups                 = {{ params['security_groups'] | replace("'","\"") }}

  tags = {
    "Name"      = "{{ profile }}_{{ resource_name }}"
    "env"       = "{{ env }}"
    "profile"   = "{{ name }}"
    "workload"  = "{{ workload }}"
    "client"    = "{{ client }}"
    "author"    = "rapid-cloud"
  }
}